{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/clearheadtodo-devs/tree-sitter-actions/schema/actions.schema.json",
  "title": "Actions File Serialization Format",
  "description": "JSON Schema for the canonical serialization of .actions files",
  "type": "object",
  "required": [
    "actions"
  ],
  "properties": {
    "actions": {
      "type": "array",
      "description": "Flat array of all actions (hierarchy via parent_id references)",
      "items": {
        "$ref": "#/definitions/action"
      }
    }
  },
  "definitions": {
    "action": {
      "type": "object",
      "required": [
        "state",
        "name"
      ],
      "properties": {
        "state": {
          "type": "string",
          "description": "Current state of the action",
          "enum": [
            "not_started",
            "completed",
            "in_progress",
            "blocked",
            "cancelled"
          ]
        },
        "name": {
          "type": "string",
          "description": "Name/title of the action",
          "minLength": 1,
          "pattern": "[^\\n$!*+@%#>]+"
        },
        "description": {
          "type": "string",
          "description": "Long-form description of the action",
          "pattern": "[^\\n]+"
        },
        "priority": {
          "type": "integer",
          "description": "Numeric priority level",
          "minimum": 0
        },
        "story": {
          "type": "string",
          "description": "Parent project/story name (root actions only)",
          "pattern": "[^\\n!$+@%#>]+"
        },
        "contexts": {
          "type": "array",
          "description": "Array of context tags",
          "items": {
            "type": "string",
            "pattern": "[^,\\n!$*@%#>]+"
          },
          "minItems": 1
        },
        "doDateTime": {
          "type": "string",
          "description": "Scheduled date/time for the action (ISO 8601 format). Note: Duration and recurrence support planned for future schema versions.",
          "pattern": "[^\\n!$*+%#>]+"
        },
        "completedDate": {
          "type": "string",
          "description": "ISO 8601 formatted completion date/time",
          "pattern": "[^\\n!$*+@#>]+"
        },
        "id": {
          "type": "string",
          "description": "UUIDv7 identifier",
          "pattern": "[0-9a-fA-F-]+"
        },
        "parent_id": {
          "type": ["string", "null"],
          "description": "UUID of parent action (null for root actions)",
          "pattern": "[0-9a-fA-F-]+"
        },
        "depth": {
          "type": "integer",
          "description": "Nesting level (0=root, 1-5=child depths)",
          "minimum": 0,
          "maximum": 5
        }
      },
      "additionalProperties": false
    }
  }
}